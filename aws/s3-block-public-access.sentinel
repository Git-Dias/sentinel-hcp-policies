# Policy que garante que todos os buckets S3 tenham o bloqueio de acesso p√∫blico ativado.
import "tfplan/v2" as tfplan

main = rule {
    all tfplan.resources.aws_s3_bucket as _, bucket {
        bucket.applied.block_public_acls == true and
        bucket.applied.ignore_public_acls == true and
        bucket.applied.block_public_policy == true and
        bucket.applied.restrict_public_buckets == true
    }
}